{
  "$schema": "http://json-schema.org/draft-07/schema",
  "type": "object",
  "properties": {
    "Pharmacist": {
      "$ref": "#/definitions/Pharmacist"
    }
  },
  "required": ["Pharmacist"],
  "title": "Pharmacist",
  "definitions": {
    "Pharmacist": {
      "$id": "#/properties/Pharmacist",
      "type": "object",
      "title": "Pharmacist Schema",
      "description": "Egyptian Healthcare Professional - Pharmacist Registration",
      "required": [
        "fullName",
        "nationalId",
        "pharmacySyndicateNumber",
        "email",
        "mobile"
      ],
      "properties": {
        "fullName": {
          "type": "string",
          "title": "Full Name"
        },
        "fullNameArabic": {
          "type": "string",
          "title": "Full Name (Arabic)"
        },
        "nationalId": {
          "type": "string",
          "title": "National ID",
          "pattern": "^[0-9]{14}$"
        },
        "pharmacySyndicateNumber": {
          "type": "string",
          "title": "Pharmacy Syndicate Number"
        },
        "pharmacyType": {
          "type": "string",
          "title": "Pharmacy Type",
          "enum": [
            "Community Pharmacy",
            "Hospital Pharmacy",
            "Clinical Pharmacy",
            "Industrial Pharmacy",
            "Research Pharmacy",
            "Regulatory Affairs",
            "Other"
          ]
        },
        "specialization": {
          "type": "string",
          "title": "Specialization",
          "enum": [
            "General Pharmacy",
            "Clinical Pharmacy",
            "Pharmaceutical Industry",
            "Pharmacology",
            "Toxicology",
            "Drug Information",
            "Oncology Pharmacy",
            "Pediatric Pharmacy",
            "Geriatric Pharmacy",
            "Nuclear Pharmacy",
            "Other"
          ]
        },
        "qualification": {
          "type": "string",
          "title": "Highest Qualification",
          "enum": [
            "B.Pharm",
            "Pharm.D",
            "M.Pharm",
            "PhD Pharmacy",
            "Fellowship",
            "Other"
          ]
        },
        "qualificationYear": {
          "type": "string",
          "title": "Year of Qualification",
          "pattern": "^[0-9]{4}$"
        },
        "university": {
          "type": "string",
          "title": "University/Institution"
        },
        "email": {
          "type": "string",
          "format": "email",
          "title": "Email Address"
        },
        "mobile": {
          "type": "string",
          "title": "Mobile Number",
          "pattern": "^\\+?[0-9]{10,15}$"
        },
        "address": {
          "type": "object",
          "title": "Address",
          "properties": {
            "street": {"type": "string"},
            "city": {"type": "string"},
            "governorate": {"type": "string"},
            "postalCode": {"type": "string"}
          }
        },
        "pharmacyName": {
          "type": "string",
          "title": "Pharmacy Name"
        },
        "pharmacyAddress": {
          "type": "string",
          "title": "Pharmacy Address"
        },
        "pharmacyLicenseNumber": {
          "type": "string",
          "title": "Pharmacy License Number"
        },
        "currentEmployer": {
          "type": "string",
          "title": "Current Employer"
        },
        "yearsOfExperience": {
          "type": "integer",
          "title": "Years of Experience",
          "minimum": 0
        },
        "licenseExpiryDate": {
          "type": "string",
          "format": "date",
          "title": "License Expiry Date"
        },
        "registrationDate": {
          "type": "string",
          "format": "date",
          "title": "Registration Date"
        },
        "status": {
          "type": "string",
          "title": "Registration Status",
          "enum": ["Active", "Inactive", "Suspended", "Pending"],
          "default": "Pending"
        },
        "profilePhoto": {
          "type": "string",
          "title": "Profile Photo URL"
        }
      }
    }
  },
  "_osConfig": {
    "privateFields": ["nationalId", "mobile", "address"],
    "signedFields": ["fullName", "pharmacySyndicateNumber", "pharmacyType"],
    "indexFields": ["pharmacySyndicateNumber", "nationalId", "email", "pharmacyType", "status"],
    "uniqueIndexFields": ["pharmacySyndicateNumber", "nationalId", "email"],
    "systemFields": ["osCreatedAt", "osUpdatedAt", "osCreatedBy", "osUpdatedBy"],
    "roles": ["Pharmacist"],
    "inviteRoles": ["Admin"],
    "ownershipAttributes": [
      {
        "email": "/email",
        "mobile": "/mobile",
        "userId": "/osOwner"
      }
    ],
    "attestationPolicies": [
      {
        "name": "pharmacistVerification",
        "conditions": "(ATTESTOR#$.pharmacySyndicateNumber#.contains(REQUESTER#$.pharmacySyndicateNumber#))",
        "type": "MANUAL",
        "attestorPlugin": "did:internal:ClaimPluginActor?entity=Admin"
      }
    ],
    "credentialTemplate": {
      "@context": [
        "https://www.w3.org/2018/credentials/v1",
        "https://healthflow.eg/credentials/v1"
      ],
      "type": ["VerifiableCredential", "PharmacistCredential"],
      "issuer": "did:healthflow:registry",
      "issuanceDate": "{{osCreatedAt}}",
      "credentialSubject": {
        "type": "Pharmacist",
        "id": "did:healthflow:pharmacist:{{pharmacySyndicateNumber}}",
        "name": "{{fullName}}",
        "pharmacySyndicateNumber": "{{pharmacySyndicateNumber}}",
        "pharmacyType": "{{pharmacyType}}",
        "specialization": "{{specialization}}"
      }
    }
  }
}
