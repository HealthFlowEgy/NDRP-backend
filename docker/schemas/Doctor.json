{
  "$schema": "http://json-schema.org/draft-07/schema",
  "type": "object",
  "properties": {
    "Doctor": {
      "$ref": "#/definitions/Doctor"
    }
  },
  "required": ["Doctor"],
  "title": "Doctor",
  "definitions": {
    "Doctor": {
      "$id": "#/properties/Doctor",
      "type": "object",
      "title": "Doctor Schema",
      "description": "Egyptian Healthcare Professional - Doctor Registration",
      "required": [
        "fullName",
        "nationalId",
        "syndicateNumber",
        "specialization",
        "email",
        "mobile"
      ],
      "properties": {
        "fullName": {
          "type": "string",
          "title": "Full Name (Arabic/English)",
          "description": "Doctor's full legal name"
        },
        "fullNameArabic": {
          "type": "string",
          "title": "Full Name (Arabic)",
          "description": "Doctor's full name in Arabic"
        },
        "nationalId": {
          "type": "string",
          "title": "National ID",
          "description": "Egyptian National ID Number (14 digits)",
          "pattern": "^[0-9]{14}$"
        },
        "syndicateNumber": {
          "type": "string",
          "title": "Medical Syndicate Number",
          "description": "Egyptian Medical Syndicate Registration Number"
        },
        "specialization": {
          "type": "string",
          "title": "Medical Specialization",
          "enum": [
            "General Practice",
            "Internal Medicine",
            "Surgery",
            "Pediatrics",
            "Obstetrics and Gynecology",
            "Cardiology",
            "Dermatology",
            "Orthopedics",
            "Ophthalmology",
            "ENT",
            "Neurology",
            "Psychiatry",
            "Radiology",
            "Anesthesiology",
            "Emergency Medicine",
            "Family Medicine",
            "Oncology",
            "Nephrology",
            "Gastroenterology",
            "Pulmonology",
            "Endocrinology",
            "Rheumatology",
            "Urology",
            "Plastic Surgery",
            "Dental",
            "Other"
          ]
        },
        "subSpecialization": {
          "type": "string",
          "title": "Sub-Specialization"
        },
        "qualification": {
          "type": "string",
          "title": "Highest Qualification",
          "enum": [
            "MBBS",
            "MD",
            "MS",
            "DNB",
            "DM",
            "MCh",
            "Fellowship",
            "PhD",
            "Other"
          ]
        },
        "qualificationYear": {
          "type": "string",
          "title": "Year of Qualification",
          "pattern": "^[0-9]{4}$"
        },
        "university": {
          "type": "string",
          "title": "University/Institution"
        },
        "email": {
          "type": "string",
          "format": "email",
          "title": "Email Address"
        },
        "mobile": {
          "type": "string",
          "title": "Mobile Number",
          "pattern": "^\\+?[0-9]{10,15}$"
        },
        "address": {
          "type": "object",
          "title": "Address",
          "properties": {
            "street": {"type": "string"},
            "city": {"type": "string"},
            "governorate": {
              "type": "string",
              "enum": [
                "Cairo", "Giza", "Alexandria", "Dakahlia", "Red Sea",
                "Beheira", "Fayoum", "Gharbiya", "Ismailia", "Menofia",
                "Minya", "Qaliubiya", "New Valley", "Suez", "Aswan",
                "Assiut", "Beni Suef", "Port Said", "Damietta", "Sharkia",
                "South Sinai", "Kafr El Sheikh", "Matrouh", "Luxor",
                "Qena", "North Sinai", "Sohag"
              ]
            },
            "postalCode": {"type": "string"}
          }
        },
        "practiceAddress": {
          "type": "string",
          "title": "Practice/Clinic Address"
        },
        "hospitalAffiliation": {
          "type": "string",
          "title": "Hospital Affiliation"
        },
        "licenseNumber": {
          "type": "string",
          "title": "Practice License Number"
        },
        "licenseExpiryDate": {
          "type": "string",
          "format": "date",
          "title": "License Expiry Date"
        },
        "registrationDate": {
          "type": "string",
          "format": "date",
          "title": "Registration Date"
        },
        "status": {
          "type": "string",
          "title": "Registration Status",
          "enum": ["Active", "Inactive", "Suspended", "Pending"],
          "default": "Pending"
        },
        "profilePhoto": {
          "type": "string",
          "title": "Profile Photo URL"
        },
        "documents": {
          "type": "array",
          "title": "Supporting Documents",
          "items": {
            "type": "object",
            "properties": {
              "documentType": {"type": "string"},
              "documentUrl": {"type": "string"},
              "uploadDate": {"type": "string", "format": "date"}
            }
          }
        }
      }
    }
  },
  "_osConfig": {
    "osComment": ["This is a comment"],
    "privateFields": ["nationalId", "mobile", "address"],
    "signedFields": ["fullName", "syndicateNumber", "specialization", "licenseNumber"],
    "indexFields": ["syndicateNumber", "nationalId", "email", "specialization", "status"],
    "uniqueIndexFields": ["syndicateNumber", "nationalId", "email"],
    "systemFields": ["osCreatedAt", "osUpdatedAt", "osCreatedBy", "osUpdatedBy"],
    "roles": ["Doctor"],
    "inviteRoles": ["Admin"],
    "ownershipAttributes": [
      {
        "email": "/email",
        "mobile": "/mobile",
        "userId": "/osOwner"
      }
    ],
    "attestationPolicies": [
      {
        "name": "doctorVerification",
        "conditions": "(ATTESTOR#$.syndicateNumber#.contains(REQUESTER#$.syndicateNumber#))",
        "type": "MANUAL",
        "attestorPlugin": "did:internal:ClaimPluginActor?entity=Admin",
        "attestationProperties": {
          "syndicateNumber": "$.syndicateNumber",
          "fullName": "$.fullName"
        }
      }
    ],
    "credentialTemplate": {
      "@context": [
        "https://www.w3.org/2018/credentials/v1",
        "https://healthflow.eg/credentials/v1"
      ],
      "type": ["VerifiableCredential", "DoctorCredential"],
      "issuer": "did:healthflow:registry",
      "issuanceDate": "{{osCreatedAt}}",
      "credentialSubject": {
        "type": "Doctor",
        "id": "did:healthflow:doctor:{{syndicateNumber}}",
        "name": "{{fullName}}",
        "syndicateNumber": "{{syndicateNumber}}",
        "specialization": "{{specialization}}",
        "licenseNumber": "{{licenseNumber}}"
      }
    }
  }
}
